{% extends "base.html" %}
{% load static %}

{# Page-specific SEO overrides: custom title + meta tags #}

{% block meta_description %}
<meta name="description" content="Change the password associated with your Regulate account.">
{% endblock %}

{% block meta_keywords %}
<meta name="keywords" content="change password, account security, regulate">
{% endblock %}

{% block title %}
<title>Regulate | Change Password</title>
{% endblock %}

{% block content %}
<div class="form-wrapper">
    <div class="form-card">

        <!-- Page heading -->
        <h1 class="form-title">Change Password</h1>

        <!-- Page instructions -->
        <p class="form-info">
            Enter your current password and choose a new one.
        </p>

        <!-- Password change form -->
        <form method="post" action="">
            {% csrf_token %}

            <!-- Non-field form errors -->
            {{ form.non_field_errors }}

            <!-- Password fields loop -->
            {% for field in form %}
                <label for="{{ field.id_for_label }}">{{ field.label }}</label>

                <div class="password-field">
                    {{ field }}

                    <!-- Password visibility toggle -->
                    <button
                        type="button"
                        class="toggle-password-btn"
                        data-target="{{ field.id_for_label }}"
                        aria-label="Show password">
                        <svg xmlns="http://www.w3.org/2000/svg"
                             viewBox="0 0 24 24"
                             aria-hidden="true">
                            <path d="M12 5C7 5 3.1 8.1 1.5 12c1.6 3.9 5.5 7 10.5 7s8.9-3.1 10.5-7C20.9 8.1 17 5 12 5zm0 11a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/>
                            <circle cx="12" cy="12" r="2.5"/>
                        </svg>
                    </button>
                </div>

                <!-- Field-level errors -->
                {% if field.errors %}
                    <p class="form-error">{{ field.errors|striptags }}</p>
                {% endif %}
            {% endfor %}

            <!-- Submit password change -->
            <button type="submit" class="select-btn">
                Change Password
            </button>
        </form>

        <!-- Auth helper links -->
        <div class="auth-extra">
            <p>
                <a href="{% url 'account_reset_password' %}">Forgot your password?</a>
            </p>
            <p>
                <a href="{% url 'profile' %}">Back to Profile</a>
            </p>
        </div>

    </div>
</div>
{% endblock %}
